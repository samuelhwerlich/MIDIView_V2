<!doctype html>
<html lang="pt-br">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MIDIVIew - Projeto de Desenho T√©cnico Avan√ßado - IFC SBS</title>
    <!-- Estilos -->
    <link rel="stylesheet" href="./css/jquery-ui.min.css" />
    <link rel="stylesheet" href="./css/jquery-ui.structure.min.css" />
    <link rel="stylesheet" href="./css/jquery-ui.theme.min.css" />
    <link rel="stylesheet" href="./css/midiview.css" />
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css" rel="stylesheet">
    <!-- Jquery -->
    <script src="./js/jquery-3.2.1.min.js"></script>
    <script src="./js/jquery-ui.min.js"></script>
</head>

<body>
    <!-- Loader -->
    <div id="loader">
        <div class="spinner"></div>
    </div>

    <!-- Conte√∫do da P√°gina -->
    <div id="main-content" style="display: none;">
        <header>
            <h1>Projeto de Desenho T√©cnico Avan√ßado</h1> <!-- T√≠tulo principal -->
            <!-- Navega√ß√£o com √≠cones -->
            <nav>
                <button id="manual_icon" data-label="Manual">
                    <i class="fas fa-book"></i>
                    <span>Manual</span>
                </button>
                <button id="midi_icon" data-label="IO MIDI">
                    <i class="fas fa-music"></i>
                    <span>IO MIDI</span>
                </button>
                <button i data-label="Configura√ß√£o MIDI">
                    <i class="fas fa-cogs"></i>
                    <span>Configura√ß√µes</span>
                </button>
                <button id="back_to_index" data-label="Voltar ao In√≠cio">
                    <i class="fas fa-arrow-left"></i>
                    <span>Voltar</span>
                </button>
            </nav>

            <!-- Janela de Di√°logo de Manual -->
            <div id="usageDialog" title="Manual">
                <h4 class="manual-title">Manual do Projeto (Em Desenvolvimento) üöÄ</h4>
                <ul>
                    <li>
                        ‚ö†Ô∏è <strong>Importante:</strong> A integra√ß√£o entre o controlador MIDI f√≠sico e o modelo virtual
                        <strong>n√£o foi implementada</strong> e n√£o est√° prevista para ser desenvolvida por nossa
                        equipe.
                        <br>üí° No entanto, essa funcionalidade pode ser explorada por outros interessados em projetos
                        futuros.
                    </li>
                    <li>
                        üéì Este site foi desenvolvido com <strong>finalidade educacional</strong>, documentando e
                        registrando o progresso deste projeto.
                    </li>
                    <li>
                        üõ†Ô∏è O projeto tem como foco principal a <strong>prototipagem</strong> e a constru√ß√£o do modelo
                        f√≠sico do controlador MIDI.
                    </li>
                    <li>
                        üé∂ O controlador MIDI √© uma ferramenta vers√°til, <strong>adapt√°vel a diversas aplica√ß√µes
                            pr√°ticas</strong>.
                    </li>
                </ul>

                <h4 class="manual-title">Para mais informa√ß√µes:</h4>
                <p>
                    Este site foi desenvolvido do zero, mas inspirado no projeto <strong>Accordion Viewer</strong>, que
                    integra um acorde√£o f√≠sico profissional com um modelo virtual.
                    <br>üîó Para mais detalhes sobre o funcionamento, recomendamos assistir √† explica√ß√£o dispon√≠vel no
                    v√≠deo no YouTube:
                    <br>
                    <a href="https://www.youtube.com/watch?v=64c1Qs2L690" target="_blank" rel="noopener noreferrer">
                        üëâ https://www.youtube.com/watch?v=64c1Qs2L690
                    </a>
                </p>

            </div>

            <!-- Janela de Configura√ß√£o de Dispositivo MIDI -->
            <div id="deviceDialog" title="Configura√ß√£o de Dispositivo MIDI">
                <div class="block_frame">
                    <span class="block_frame_title">Configura√ß√£o de Dispositivo MIDI</span>
                    <div id="midi_dev">
                        <table>
                            <tr>
                                <td>Entrada:
                                    <form name="input_device_select">
                                        <select name="ids" onChange="inputDeviceSelect(this);">
                                            <option value="0">Nenhum Dispositivo</option>
                                        </select>
                                    </form>
                                </td>
                                <td width="40"></td>
                                <td>Sa√≠da:
                                    <form name="output_device_select">
                                        <select name="ids" onChange="outputDeviceSelect(this);">
                                            <option value="0">Nenhum Dispositivo</option>
                                        </select>
                                    </form>
                                </td>
                            </tr>
                        </table>
                    </div>
                </div>
            </div>
        </header>

        <section>
            <!-- Script para abertura dos di√°logos -->
            <script>
                $(function () {
                    $("#usageDialog").dialog({
                        autoOpen: false,
                        height: 800,
                        width: 800,
                        modal: true,
                        show: { effect: "fade", duration: 800 },
                        hide: { effect: "fade", duration: 500 }
                    });
                    $("#deviceDialog").dialog({
                        autoOpen: false,
                        height: 200,
                        width: 450,
                        modal: true,
                        show: { effect: "fade", duration: 800 },
                        hide: { effect: "fade", duration: 500 }
                    });

                    $("#usage").on("click", function () { $("#usageDialog").dialog("open"); });
                    $("#device").on("click", function () { $("#deviceDialog").dialog("open"); });
                });
            </script>


            <div class="center">
                <div class="container">
                    <!-- Imagem de fundo -->
                    <img src="img/box-view_up-nbg.png" alt="Caixa Base" class="base-image">

                    <!-- Sobreposi√ß√£o da tampa -->
                    <div class="tampa">
                        <!-- Furos nos cantos -->
                        <div class="corner-hole top-left"></div>
                        <div class="corner-hole top-right"></div>
                        <div class="corner-hole bottom-left"></div>
                        <div class="corner-hole bottom-right"></div>
                        <!-- Reflexo na tampa -->
                        <div class="reflection"></div>
                        <!-- Bot√µes -->
                        <svg class="buttons" id="buttons" viewBox="0 0 1000 500">

                        </svg>
                    </div>
                </div>

                <script>
                    /// Configura√ß√µes dos bot√µes
                    const rows = 5; // N√∫mero de linhas de bot√µes
                    const cols = 8; // N√∫mero de colunas de bot√µes
                    const buttonRadius = 8; // Raio dos bot√µes (parte superior)
                    const baseRadius = 14.5; // Raio da base cil√≠ndrica
                    const baseHeight = 45; // Altura da base
                    const buttonHeight = 800; // Altura do bot√£o 
                    const spacingX = 35; // Espa√ßamento horizontal entre bot√µes
                    const spacingY = 28; // Espa√ßamento vertical

                    // Posi√ß√£o inicial dos bot√µes
                    const startX = 150; // Margem esquerda da tampa
                    const startY = 200; // Margem superior para centralizar na tampa

                    // Frequ√™ncias das notas para 40 bot√µes no sistema Stradella (baixos fundamentais)
                    const frequencies = [
                        65.41,  // C (D√≥)
                        73.42,  // D (R√©)
                        82.41,  // E (Mi)
                        87.31,  // F (F√°)
                        98.00,  // G (Sol)
                        110.00, // A (L√°)
                        123.47, // B (Si)
                        130.81, // C (D√≥ - oitava superior)
                        146.83, // D (R√© - oitava superior)
                        164.81, // E (Mi - oitava superior)
                        174.61, // F (F√° - oitava superior)
                        196.00, // G (Sol - oitava superior)
                        220.00, // A (L√° - oitava superior)
                        246.94, // B (Si - oitava superior)
                        261.63, // C (D√≥ - oitava superior)
                        293.66, // D (R√© - oitava superior)
                        329.63, // E (Mi - oitava superior)
                        349.23, // F (F√° - oitava superior)
                        392.00, // G (Sol - oitava superior)
                        440.00, // A (L√° - oitava superior),
                        493.88, // B (Si - oitava superior)
                        523.25, // C (D√≥ - oitava superior)
                        587.33, // D (R√© - oitava superior)
                        659.25, // E (Mi - oitava superior)
                        698.46, // F (F√° - oitava superior)
                        783.99, // G (Sol - oitava superior)
                        880.00, // A (L√° - oitava superior)
                        987.77, // B (Si - oitava superior)
                        1046.50, // C (D√≥ - oitava superior)
                        1174.66, // D (R√© - oitava superior)
                        1318.51, // E (Mi - oitava superior)
                        1396.91, // F (F√° - oitava superior)
                        1567.98, // G (Sol - oitava superior)
                        1760.00, // A (L√° - oitava superior)
                        1975.53, // B (Si - oitava superior)
                        2093.00, // C (D√≥ - oitava superior)
                        2349.32, // D (R√© - oitava superior)
                        2637.02, // E (Mi - oitava superior)
                        2793.83  // F (F√° - oitava superior)
                    ];

                    // Criar os bot√µes SVG
                    const buttonsGroup = document.getElementById('buttons');

                    for (let row = 0; row < rows; row++) {
                        for (let col = 0; col < cols; col++) {
                            const x = startX + col * spacingX + row * 15; // Coordenada X com deslocamento diagonal
                            const y = startY + row * spacingY; // Coordenada Y

                            // Criar a base cil√≠ndrica
                            const base = document.createElementNS('http://www.w3.org/2000/svg', 'circle');
                            base.setAttribute('cx', x); // Coordenada X
                            base.setAttribute('cy', y); // Coordenada Y
                            base.setAttribute('r', baseRadius); // Raio da base
                            base.setAttribute('height', baseHeight); // Altura da base
                            base.setAttribute('class', 'btn-base');
                            base.setAttribute('stroke-width', 6); // Aumenta a espessura da lateral da base
                            buttonsGroup.appendChild(base);

                            // Criar o bot√£o elevado no topo da base
                            const top = document.createElementNS('http://www.w3.org/2000/svg', 'circle');
                            top.setAttribute('cx', x); // Coordenada X
                            top.setAttribute('cy', y - 5); // Eleva√ß√£o inicial
                            top.setAttribute('r', buttonRadius); // Raio do bot√£o
                            top.setAttribute('height', buttonHeight); // Altura do bot√£o
                            top.setAttribute('class', 'btn-top');
                            buttonsGroup.appendChild(top);

                            // Adicionar evento de clique no bot√£o
                            top.addEventListener('click', () => {
                                playSound(frequencies[row * cols + col]); // Tocar a frequ√™ncia associada ao bot√£o
                            });
                        }
                    }

                    // Fun√ß√£o para tocar o som
                    function playSound(frequency) {
                        const audioContext = new (window.AudioContext || window.webkitAudioContext)();
                        const oscillator = audioContext.createOscillator(); // Criar oscilador
                        oscillator.type = 'sine'; // Tipo de onda (senoide)
                        oscillator.frequency.setValueAtTime(frequency, audioContext.currentTime); // Definir a frequ√™ncia
                        oscillator.connect(audioContext.destination); // Conectar o oscilador aos alto-falantes
                        oscillator.start(); // Come√ßar o som
                        oscillator.stop(audioContext.currentTime + 1); // Parar o som ap√≥s 0.5 segundos
                    }
                </script>



            </div>
        </section>
        <footer>
            <h1>Controlador MIDI Virtual</h1>
        </footer>
    </div>
    <!-- Navega√ß√£o com √≠cones -->

    <!-- Scripts Principais -->
    <script src="./js/midi_service.js"></script>
    <script src="./js/midiview.js"></script>
    <script>
        // Controle do Loader
        window.addEventListener("load", function () {
            // Oculta o loader
            const loader = document.getElementById("loader");
            const mainContent = document.getElementById("main-content");

            if (loader && mainContent) {
                loader.style.display = "none";
                mainContent.style.display = "block";
            } else {
                console.error("Loader ou Main Content n√£o encontrado!");
            }
        });
    </script>
</body>

</html>